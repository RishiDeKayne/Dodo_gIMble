#De-Kayne 2024
#make working directory
#mkdir -p /global/scratch/users/rdekayne/dodo && cd /global/scratch/users/rdekayne/dodo

### conda installs
conda create -p /global/scratch/users/rdekayne/envs/gimble
source activate base
conda activate /global/scratch/users/rdekayne/envs/gimble
conda install -c conda-forge gimble
conda install -c bioconda gimbleprep
conda install conda-forge::rclone
conda install samtools
conda install bioconda::bedtools

rclone copy --drive-shared-with-me drive:Rishi/ .
rclone copy --drive-shared-with-me drive:Rishi/*vcf* .

samtools faixd Nicobar2.fasta

# cram_to_bam.sh

#!/bin/bash
#SBATCH --job-name=convert
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --qos=savio_lowprio
#SBATCH --output=convert.%j.out # output file
#SBATCH --error=convert.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer

GENOME=$1
CRAM=$2
BAM=$3

samtools view -b -T ${GENOME} -o ${BAM} ${CRAM}

touch ${CRAM}_converted.done

##run
sbatch cram_to_bam.sh Nicobar2.fasta SMF048.cram SMF048.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF046.cram SMF046.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF045.cram SMF045.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF044.cram SMF044.bam
sbatch cram_to_bam.sh Nicobar2.fasta DodoxNicobar.cram DodoxNicobar.bam
sbatch cram_to_bam.sh Nicobar2.fasta ManumeaxNicobar.cram ManumeaxNicobar.bam
sbatch cram_to_bam.sh Nicobar2.fasta SolitairexNicobar.cram SolitairexNicobar.bam

mv DodoxNicobar.bam Dodo.bam
mv ManumeaxNicobar.bam Manumea.bam
mv SolitairexNicobar.bam Solitaire.bam

# index_bams.sh

#!/bin/bash
#SBATCH --job-name=index
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=index.%j.out # output file
#SBATCH --error=index.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer

samtools index ./Dodo.bam
samtools index ./Manumea.bam
samtools index ./Solitaire.bam
samtools index ./SMF045.bam

touch all.indices.done

##run
sbatch index_bams.sh

#want to run gIMble on focal indivs, 1 for each morph - put in gimble.indiv.list
#DODO = do : "Dodo"
#MANUMEA = ma : "Manumea"
#SOLITAIRE = so : "Solitaire"
#NICOBAR = ni : "SMF045"

#subset overall vcf and then may symlinks to the realigned.bam files for each of these indivs
#using /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments.vcf.gz

bcftools filter -Oz /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments.vcf.gz -e 'AN < 14' | bcftools view -m2 -M2 -v snps | bcftools sort --temp-dir /global/scratch/users/rdekayne/dodo/data/tmp/ -Oz -o /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz

bcftools view -H /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz | wc -l
#10902319

##4_samples_list.txt
Dodo
Manumea
Solitaire
SMF045

bcftools view -Oz -S 4_samples_list.txt -m2 -M2 /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz | bcftools view -m2 -M2 | bcftools sort --temp-dir /global/scratch/users/rdekayne/dodo/data/tmp/ -Oz -o /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz

bcftools view -H /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz | wc -l
10902319

conda activate /global/scratch/users/rdekayne/envs/mapping

#add RGs
#[X] Sample IDs in readgroups of BAM files : 10, 30, 40, 20
#[X] Sample names in VCF file : Dodo, Manumea, Solitaire, SMF045

## addRG.sh
#!/bin/bash
#SBATCH --job-name=pic
#SBATCH --time=0-24:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=pic.%j.out # output file
#SBATCH --error=pic.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer
#SBATCH --cpus-per-task=24 # 2 CPUs per job

module load java/22.0.1

picard AddOrReplaceReadGroups \
       I=Dodo.bam \
       O=DodoRG.bam \
       RGID=4 \
       RGLB=lib1 \
       RGPL=ILLUMINA \
       RGPU=unit1 \
       RGSM=Dodo

picard AddOrReplaceReadGroups \
       I=Manumea.bam \
       O=ManumeaRG.bam \
       RGID=4 \
       RGLB=lib1 \
       RGPL=ILLUMINA \
       RGPU=unit1 \
       RGSM=Manumea

picard AddOrReplaceReadGroups \
       I=Solitaire.bam \
       O=SolitaireRG.bam \
       RGID=4 \
       RGLB=lib1 \
       RGPL=ILLUMINA \
       RGPU=unit1 \
       RGSM=Solitaire

picard AddOrReplaceReadGroups \
       I=SMF045.bam \
       O=SMF045RG.bam \
       RGID=4 \
       RGLB=lib1 \
       RGPL=ILLUMINA \
       RGPU=unit1 \
       RGSM=SMF045

touch all.done

##run
sbatch addRG.sh

# index_bams2.sh

#!/bin/bash
#SBATCH --job-name=index
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=index.%j.out # output file
#SBATCH --error=index.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer

samtools index ./DodoRG.bam
samtools index ./ManumeaRG.bam
samtools index ./SolitaireRG.bam
samtools index ./SMF045RG.bam

touch all.indices.done

##run
sbatch index_bams2.sh

#make symlinks for bam files in bam directory
##ln -s source_file myfile

ln -s ../data/DodoRG.bam
ln -s ../data/DodoRG.bam.bai

ln -s ../data/ManumeaRG.bam
ln -s ../data/ManumeaRG.bam.bai

ln -s ../data/SolitaireRG.bam
ln -s ../data/SolitaireRG.bam.bai

ln -s ../data/SMF045RG.bam
ln -s ../data/SMF045RG.bam.bai

##############################################
#                STEP1 - gimbleprep
##############################################

# 01_gimbleprep.sh

#!/bin/bash
#SBATCH --job-name=gimb1
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=gimb1.%j.out # output file
#SBATCH --error=gimb1.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=20 # One task per computer

gimbleprep -f /global/scratch/users/rdekayne/dodo/data/Nicobar2.fasta -v /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz -b /global/scratch/users/rdekayne/dodo/gimble/ -t 20 -o /global/scratch/users/rdekayne/dodo/gimble/run1

touch /global/scratch/users/rdekayne/dodo/gimble/preprocess.done

##run
sbatch 01_gimbleprep.sh

#get nicobar gff as bedl
cat Nicobar2.polished.gff | grep -v "#" | cut -f1 > Nicobar2.gff.chrom.txt
cat Nicobar2.polished.gff | grep -v "#" | cut -f4 > Nicobar2.gff.start.txt
cat Nicobar2.polished.gff | grep -v "#" | cut -f5 > Nicobar2.gff.end.txt
paste Nicobar2.gff.chrom.txt Nicobar2.gff.start.txt Nicobar2.gff.end.txt > Nicobar2.gff.bed

#make gimble bed
bedtools subtract -a run1.bed -b ../data/Nicobar2.gff.bed > gimble.intergenic.bed

#pre filtering
wc -l run1.bed
#42315640 run1.bed

#post filtering
wc -l gimble.intergenic.bed 
#22399378 gimble.intergenic.bed

bcftools query -l ./run1.vcf.gz
##
Dodo
Manumea
Solitaire
SMF045

#DodoManumea.samples.csv
Dodo,do
Manumea,man

#DodoSolitaire.samples.csv
Dodo,do
Solitaire,sol

#DodoSMF045.samples.csv
Dodo,do
SMF045,nic

#ManumeaSolitaire.samples.csv
Manumea,man
Solitaire,sol

#ManumeaSMF045.samples.csv
Manumea,man
SMF045,nic

#SolitaireSMF045.samples.csv
Solitaire,sol
SMF045,nic

ls *.samples.csv | grep -v "run1" > samples.txt
sed 's/.samples.csv//g' samples.txt > sample_names.txt

######PARSE

#gimble_parse_template.sh

#!/bin/bash
#SBATCH --job-name=parse
#SBATCH --time=0-24:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=parse.%j.out # output file
#SBATCH --error=parse.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=4 # One task per computer

gimble parse -v /global/scratch/users/rdekayne/dodo/gimble/run1.vcf.gz -b /global/scratch/users/rdekayne/dodo/gimble/gimble.intergenic.bed -g /global/scratch/users/rdekayne/dodo/gimble/run1.genomefile -s sample_placeholder -z sample_placeholder_store

touch sample_placeholder.parse.done

##
cat samples.txt | while read sample
do
sed 's/sample_placeholder/'"${sample}"'/g' gimble_parse_template.sh > gimble_parse_${sample}.sh
done

##
ls gimble_parse_*.csv.sh
sbatch gimble_parse_DodoManumea.samples.csv.sh
sbatch gimble_parse_DodoSolitaire.samples.csv.sh  
sbatch gimble_parse_ManumeaSolitaire.samples.csv.sh
sbatch gimble_parse_DodoSMF045.samples.csv.sh   
sbatch gimble_parse_ManumeaSMF045.samples.csv.sh  
sbatch gimble_parse_SolitaireSMF045.samples.csv.sh


######BLOCKS
touch blocks.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble blocks -z ${sample}_${bed}_store.z -l 64" >> blocks.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_blocks -V -pe smp64 20 -l h=bigbird -b yes {}' :::: blocks.gimble.run


######WINDOWS
touch windows.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble windows -z ${sample}_${bed}_store.z -w 500 -s 100" >> windows.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_windows -V -pe smp64 20 -l h=bigbird -b yes {}' :::: windows.gimble.run


######INFO
touch info.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble info -z ${sample}_${bed}_store.z" >> info.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_info -V -pe smp64 20 -l h=bigbird -b yes {}' :::: info.gimble.run


######TALLY
touch tally.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble tally -z ${sample}_${bed}_store.z -k 2,2,2,2 -l blocks_kmax2 -t blocks" >> tally.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_tally -V -pe smp64 20 -l h=bigbird -b yes {}' :::: tally.gimble.run

######OPTIMIZE

touch optimize.div.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,6_000_000 -m DIV -l DIV -f" >> optimize.div.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.div.gimble.run

grep "COMPLETED" *.o*

touch optimize.IM_AB.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,7_000_000 -M=0,2.21E-04 -m IM_AB -l IM_AB -f" >> optimize.IM_AB.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.IM_AB.gimble.run

touch optimize.IM_BA.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,7_000_000 -M=0,2.21E-04 -m IM_BA -l IM_BA -f" >> optimize.IM_BA.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.IM_BA.gimble.run


#####QUERY output
#INV1.1
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


#INV1.2
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA

#INV2
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA

#INV4
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA




https://www.science.org/doi/10.1126/science.aao0960
https://academic.oup.com/evlett/article/7/4/216/7202139
