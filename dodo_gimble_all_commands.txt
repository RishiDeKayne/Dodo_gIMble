#De-Kayne 2024
#make working directory
#mkdir -p /global/scratch/users/rdekayne/dodo && cd /global/scratch/users/rdekayne/dodo

### conda installs
conda create -p /global/scratch/users/rdekayne/envs/gimble
source activate base
conda activate /global/scratch/users/rdekayne/envs/gimble
conda install -c conda-forge gimble
conda install -c bioconda gimbleprep
conda install conda-forge::rclone
conda install samtools

rclone copy --drive-shared-with-me drive:Rishi/ .
rclone copy --drive-shared-with-me drive:Rishi/*vcf* .

samtools faixd Nicobar2.fasta

# cram_to_bam.sh

#!/bin/bash
#SBATCH --job-name=convert
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --qos=savio_lowprio
#SBATCH --output=convert.%j.out # output file
#SBATCH --error=convert.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer

GENOME=$1
CRAM=$2
BAM=$3

samtools view -b -T ${GENOME} -o ${BAM} ${CRAM}

touch ${CRAM}_converted.done

##run
sbatch cram_to_bam.sh Nicobar2.fasta SMF048.cram SMF048.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF046.cram SMF046.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF045.cram SMF045.bam
sbatch cram_to_bam.sh Nicobar2.fasta SMF044.cram SMF044.bam
sbatch cram_to_bam.sh Nicobar2.fasta DodoxNicobar.cram DodoxNicobar.bam
sbatch cram_to_bam.sh Nicobar2.fasta ManumeaxNicobar.cram ManumeaxNicobar.bam
sbatch cram_to_bam.sh Nicobar2.fasta SolitairexNicobar.cram SolitairexNicobar.bam

mv DodoxNicobar.bam Dodo.bam
mv ManumeaxNicobar.bam Manumea.bam
mv SolitairexNicobar.bam Solitaire.bam

# index_bams.sh

#!/bin/bash
#SBATCH --job-name=index
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=index.%j.out # output file
#SBATCH --error=index.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=1 # One task per computer

samtools index ./Dodo.bam
samtools index ./Manumea.bam
samtools index ./Solitaire.bam
samtools index ./SMF045.bam

touch all.indices.done

##run
sbatch index_bams.sh

#want to run gIMble on focal indivs, 1 for each morph - put in gimble.indiv.list
#DODO = do : "Dodo"
#MANUMEA = ma : "Manumea"
#SOLITAIRE = so : "Solitaire"
#NICOBAR = ni : "SMF045"

#subset overall vcf and then may symlinks to the realigned.bam files for each of these indivs
#using /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments.vcf.gz

bcftools filter -Oz /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments.vcf.gz -e 'AN < 14' | bcftools view -m2 -M2 -v snps | bcftools sort --temp-dir /global/scratch/users/rdekayne/dodo/data/tmp/ -Oz -o /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz

bcftools view -H /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz | wc -l
#10902319

##4_samples_list.txt
Dodo
Manumea
Solitaire
SMF045

bcftools view -Oz -S 4_samples_list.txt -m2 -M2 /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps.vcf.gz | bcftools view -m2 -M2 | bcftools sort --temp-dir /global/scratch/users/rdekayne/dodo/data/tmp/ -Oz -o /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz

bcftools view -H /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz | wc -l
10902319

#make symlinks for bam files in bam directory
##ln -s source_file myfile

ln -s ../data/Dodo.bam
ln -s ../data/Dodo.bam.bai

ln -s ../data/Manumea.bam
ln -s ../data/Manumea.bam.bai

ln -s ../data/Solitaire.bam
ln -s ../data/Solitaire.bam.bai

ln -s ../data/SMF045.bam
ln -s ../data/SMF045.bam.bai

##############################################
#                STEP1 - gimbleprep
##############################################

# 01_gimbleprep.sh

#!/bin/bash
#SBATCH --job-name=gimb1
#SBATCH --time=0-12:00:00 # Wall clock time limit in Days-Hours:min:seconds
#SBATCH --account=co_genomicdata
#SBATCH --partition=savio3
#SBATCH --output=gimb1.%j.out # output file
#SBATCH --error=gimb1.%j.err # error file
#SBATCH --ntasks=1 # Run 1 job
#SBATCH --ntasks-per-node=20 # One task per computer

gimbleprep -f /global/scratch/users/rdekayne/dodo/data/Nicobar2.fasta -v /global/scratch/users/rdekayne/dodo/data/Nicobar_Alignments_AN14_m2M2_snps_4samples.vcf.gz -b /global/scratch/users/rdekayne/dodo/gimble/ -t 20 -o /global/scratch/users/rdekayne/dodo/gimble/run1

touch /global/scratch/users/rdekayne/dodo/gimble/preprocess.done

##run
sbatch 01_gimbleprep.sh

get nicobar gff as bed
cat Nicobar2.polished.gff | grep -v "#" | cut -f1 > Nicobar2.gff.chrom.txt
cat Nicobar2.polished.gff | grep -v "#" | cut -f4 > Nicobar2.gff.start.txt
cat Nicobar2.polished.gff | grep -v "#" | cut -f5 > Nicobar2.gff.end.txt
paste Nicobar2.gff.chrom.txt Nicobar2.gff.start.txt Nicobar2.gff.end.txt > Nicobar2.gff.bed

#make gimble bed file for small chrom

echo 'CM069651.1  1  6780555' > chrCM069651.bed
bedtools intersect -a ../../ref_run.bed -b chrCM069651.bed > gimble.chrCM069651.bed
bedtools subtract -a gimble.chrCM069651.bed -b Nicobar2.gff.bed > gimble.intergenic.chrCM069651.bed








#want to make a bed file for each inversion that excludes annotations within them
mkdir -p /scratch/rdekayne/gimble3/reference_indivs_gimble3/bedfiles && cd /scratch/rdekayne/gimble3/reference_indivs_gimble3/bedfiles

echo 'contig15.1  4035981  5322257' > inv1.1.bed
echo 'contig15.1  5323805  6220875' > inv1.2.bed
echo 'contig15.1  6251636 7829094' > inv2.bed
echo 'contig15.1  14803486  15299732' > inv4.bed

bedtools intersect -a ../../ref_run.bed -b inv1.1.bed > gimble.inv1.1.bed
bedtools intersect -a ../../ref_run.bed -b inv1.2.bed > gimble.inv1.2.bed
bedtools intersect -a ../../ref_run.bed -b inv2.bed > gimble.inv2.bed
bedtools intersect -a ../../ref_run.bed -b inv4.bed > gimble.inv4.bed

wc -l gimble.inv*
#   80361 gimble.inv1.1.bed
#   57217 gimble.inv1.2.bed
#   94876 gimble.inv2.bed
#   24238 gimble.inv4.bed
#  256692 total

bedtools subtract -a gimble.inv1.1.bed -b /data/martin/genomics/analyses/Danaus_genome/Dchry2/braker_annotation_RDK_Dchry2_2/Dchry2.2.fa.masked_annotation_a001.sequences.tidy.gff3.bed > gimble.intergenic.inv1.1.bed
bedtools subtract -a gimble.inv1.2.bed -b /data/martin/genomics/analyses/Danaus_genome/Dchry2/braker_annotation_RDK_Dchry2_2/Dchry2.2.fa.masked_annotation_a001.sequences.tidy.gff3.bed > gimble.intergenic.inv1.2.bed
bedtools subtract -a gimble.inv2.bed -b /data/martin/genomics/analyses/Danaus_genome/Dchry2/braker_annotation_RDK_Dchry2_2/Dchry2.2.fa.masked_annotation_a001.sequences.tidy.gff3.bed > gimble.intergenic.inv2.bed
bedtools subtract -a gimble.inv4.bed -b /data/martin/genomics/analyses/Danaus_genome/Dchry2/braker_annotation_RDK_Dchry2_2/Dchry2.2.fa.masked_annotation_a001.sequences.tidy.gff3.bed > gimble.intergenic.inv4.bed

wc -l *.intergenic*
#   49100 gimble.intergenic.inv1.1.bed
#   40147 gimble.intergenic.inv1.2.bed
#   64910 gimble.intergenic.inv2.bed
#   19560 gimble.intergenic.inv4.bed
#  173717 total

mkdir -p /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/invs
cp gimble.intergenic.*.bed /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/invs/
bcftools query -l ./DC174_allchroms_chr1HAP_output_filt_mindepth7_minqual30_mac4_AN313_AN224_nosmallcontigs_reference_individuals3.b.vcf.gz
#klu
SM15W61
SM15W66
SM15W69
SM15W72
SM15W74
SM18W01
#ori
SM21TS03
SM21TS05
SM21TS16
SM21TS33
SM21TS34
SM21TS35
SM21TS36
#chr
SM16N01
SM16N04
SM16N05
SM16N06
SM16N20
SM16N37
#kar
SM21SP06
SM21SP09
#different sample files for different comparisons

#kluori.samples.csv
SM15W61,klu
SM15W66,klu
SM15W69,klu
SM15W72,klu
SM15W74,klu
SM18W01,klu
SM21TS03,ori
SM21TS05,ori
SM21TS16,ori
SM21TS33,ori
SM21TS34,ori
SM21TS35,ori
SM21TS36,ori

#chrori.samples.csv
SM16N01,chr
SM16N04,chr
SM16N05,chr
SM16N06,chr
SM16N20,chr
SM16N37,chr
SM21TS03,ori
SM21TS05,ori
SM21TS16,ori
SM21TS33,ori
SM21TS34,ori
SM21TS35,ori
SM21TS36,ori

#chrklu.samples.csv
SM16N01,chr
SM16N04,chr
SM16N05,chr
SM16N06,chr
SM16N20,chr
SM16N37,chr
SM15W61,klu
SM15W66,klu
SM15W69,klu
SM15W72,klu
SM15W74,klu
SM18W01,klu

#karklu.samples.csv
SM21SP06,kar
SM21SP09,kar
SM15W61,klu
SM15W66,klu
SM15W69,klu
SM15W72,klu
SM15W74,klu
SM18W01,klu

#karori.samples.csv
SM21SP06,kar
SM21SP09,kar
SM21TS03,ori
SM21TS05,ori
SM21TS16,ori
SM21TS33,ori
SM21TS34,ori
SM21TS35,ori
SM21TS36,ori

#karchr.samples.csv
SM21SP06,kar
SM21SP09,kar
SM16N01,chr
SM16N04,chr
SM16N05,chr
SM16N06,chr
SM16N20,chr
SM16N37,chr

wc -l *.samples.csv
# 12 chrklu.samples.csv
# 13 chrori.samples.csv
#  8 karchr.samples.csv
#  8 karklu.samples.csv
#  9 karori.samples.csv
# 13 kluori.samples.csv
# 63 total

ls *.csv > samples.txt
sed 's/.samples.csv//g' samples.txt > sample_names.txt
ls *.bed > bed_files.txt

######PARSE
touch parse.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble parse -v /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/ref_run.vcf.gz -b /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/invs/${bed} -g /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/ref_run.genomefile -s ${sample} -z ${sample}_${bed}_store" >> parse.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_parse -V -pe smp64 20 -l h=bigbird -b yes {}' :::: parse.gimble.run

######BLOCKS
touch blocks.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble blocks -z ${sample}_${bed}_store.z -l 64" >> blocks.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_blocks -V -pe smp64 20 -l h=bigbird -b yes {}' :::: blocks.gimble.run


######WINDOWS
touch windows.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble windows -z ${sample}_${bed}_store.z -w 500 -s 100" >> windows.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_windows -V -pe smp64 20 -l h=bigbird -b yes {}' :::: windows.gimble.run


######INFO
touch info.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble info -z ${sample}_${bed}_store.z" >> info.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_info -V -pe smp64 20 -l h=bigbird -b yes {}' :::: info.gimble.run


######TALLY
touch tally.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble tally -z ${sample}_${bed}_store.z -k 2,2,2,2 -l blocks_kmax2 -t blocks" >> tally.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_tally -V -pe smp64 20 -l h=bigbird -b yes {}' :::: tally.gimble.run

######OPTIMIZE

touch optimize.div.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,6_000_000 -m DIV -l DIV -f" >> optimize.div.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.div.gimble.run

grep "COMPLETED" *.o*

touch optimize.IM_AB.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,7_000_000 -M=0,2.21E-04 -m IM_AB -l IM_AB -f" >> optimize.IM_AB.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.IM_AB.gimble.run

touch optimize.IM_BA.gimble.run
cat samples.txt | while read sample
do
cat bed_files.txt | while read bed
do
echo "/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble optimize -z ${sample}_${bed}_store.z -d tally/blocks_kmax2 -r A -u 2e-9 -g CRS2 -p 1 -s midpoint -i 20000 -A=80_000,6_000_000 -B=80_000,6_000_000 -C=80_000,6_000_000 -T=0,7_000_000 -M=0,2.21E-04 -m IM_BA -l IM_BA -f" >> optimize.IM_BA.gimble.run
done
done

parallel -j 1 'qsub -cwd -N gimble_div_optimize -V -pe smp64 20 -l h=bigbird -b yes {}' :::: optimize.IM_BA.gimble.run


#####QUERY output
#INV1.1
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.1.bed_store.z -l optimize/blocks_kmax2/IM_BA


#INV1.2
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv1.2.bed_store.z -l optimize/blocks_kmax2/IM_BA

#INV2
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv2.bed_store.z -l optimize/blocks_kmax2/IM_BA

#INV4
/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/chrori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/kluori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karklu.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karori.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA


/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/DIV

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_AB

/data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/gimble/gimble query -z /data/martin/genomics/analyses/Danaus_popgen/DC174/analysis/gimble/3rdindiv_set/karchr.samples.csv_gimble.intergenic.inv4.bed_store.z -l optimize/blocks_kmax2/IM_BA




https://www.science.org/doi/10.1126/science.aao0960
https://academic.oup.com/evlett/article/7/4/216/7202139
